# Search query templates (vetted sources)

This document defines **placeholder search queries** for the latest bugs and vulnerabilities. All sources are official or widely used government/industry sources. Use these as templates when building fetchers or manual searches.

---

## 1. NIST National Vulnerability Database (NVD)

**Owner:** U.S. NIST  
**Vetted:** Official U.S. government database; CVE data with CVSS and CPE.

| Resource | URL | Notes |
|----------|-----|--------|
| NVD home | https://nvd.nist.gov/ | |
| API start | https://nvd.nist.gov/developers/start-here | API key recommended (50 req/30s); 5 req/30s without key. |
| CVE API 2.0 | https://nvd.nist.gov/developers/vulnerabilities | GET; params: `cveId`, `lastModStartDate`, `lastModEndDate`, `keywordSearch`, `cvssV2Severity`, `cvssV3Severity`, `startIndex`, `resultsPerPage`. |

**Example query parameters (placeholder):**

- **By CVE ID:** `GET .../vulnerabilities?cveId=CVE-2024-XXXX`
- **By date (last modified):** `lastModStartDate=YYYY-MM-DDThh:mm:ss&lastModEndDate=...` (ISO 8601, UTC)
- **By keyword:** `keywordSearch=openssl` (product/vendor)
- **By severity:** `cvssV3Severity=HIGH` or `CRITICAL`

**Terms:** Services using NVD API must display: "This product uses the NVD API but is not endorsed or certified by the NVD."

---

## 2. CVE (MITRE)

**Owner:** MITRE  
**Vetted:** Industry-standard CVE identifiers and records.

| Resource | URL | Notes |
|----------|-----|--------|
| CVE list | https://cve.mitre.org/ | |
| Data downloads | https://cve.mitre.org/data/downloads/index.html | JSON (CVE Record v5.2); cvelistV5 on GitHub for bulk. |
| CVE Services API | https://cveawg.mitre.org/api-docs/ | Swagger; `GET /cve/{id}`, `GET /cve` with filters. |

**Example query (placeholder):**

- **Single CVE:** `GET https://cveawg.mitre.org/api/cve/CVE-YYYY-NNNNN`
- **Bulk:** Use [cvelistV5](https://github.com/CVEProject/cvelistV5) for full dataset; daily baseline, hourly deltas.

---

## 3. CWE (MITRE)

**Owner:** MITRE  
**Vetted:** Common Weakness Enumeration; taxonomy of software weaknesses.

| Resource | URL | Notes |
|----------|-----|--------|
| CWE home | https://cwe.mitre.org/ | |
| Downloads | https://cwe.mitre.org/data/downloads.html | XML, CSV, HTML. |
| CWE REST API | https://github.com/CWE-CAPEC/cwe-api | JSON; query by CWE ID or view. |

**Example query (placeholder):**

- **By CWE ID:** e.g. CWE-79 (XSS), CWE-89 (SQLi), CWE-78 (OS command injection), CWE-94 (code injection) for injection-related checks.
- **By view:** Use CWE views (e.g. "Research concepts") to get categories relevant to network/container/cloud (misconfig, injection, crypto).

---

## 4. OSV (Open Source Vulnerabilities)

**Owner:** Google (OpenSSF)  
**Vetted:** Distributed vulnerability DB for open source; used by many ecosystems.

| Resource | URL | Notes |
|----------|-----|--------|
| OSV home | https://osv.dev/ | |
| API 1.0 | https://google.github.io/osv.dev/api/ | Query by package/version or by OSV ID. |
| Quickstart | https://google.github.io/osv.dev/quickstart/ | |

**Example query (placeholder):**

- **By package + version:** POST to `/v1/query` with `package.name`, `package.ecosystem` (e.g. `Debian`, `PyPI`, `npm`), `version`.
- **By commit:** POST with `commit` hash for unversioned ecosystems.
- **Batched:** POST to `/v1/querybatch` for multiple packages.

**Ecosystems (examples):** Debian, Ubuntu, PyPI, npm, Go, Maven, etc.

---

## 5. CISA Known Exploited Vulnerabilities (KEV)

**Owner:** U.S. CISA  
**Vetted:** U.S. government catalog of CVEs known to be exploited in the wild.

| Resource | URL | Notes |
|----------|-----|--------|
| KEV catalog | https://www.cisa.gov/known-exploited-vulnerabilities-catalog | |
| Download | Catalog page provides CSV and JSON download of full KEV list. | Filter/sort by date added, vendor, product. |

**Example use (placeholder):**

- **Full list:** Download CSV/JSON; filter by date or product to get "new in the wild" items.
- **Check CVE:** Look up a CVE ID in the catalog to see if it is known exploited; prioritize these in scanner output or remediation.

---

## 6. GitHub Advisory Database

**Owner:** GitHub  
**Vetted:** GitHub-reviewed security advisories (GHSA) linked to CVEs; many ecosystems.

| Resource | URL | Notes |
|----------|-----|--------|
| Advisories | https://github.com/advisories | |
| REST API (global advisories) | https://docs.github.com/en/rest/security-advisories/global-advisories | Filter by GHSA ID, CVE ID, ecosystem, severity, CWE. |

**Example query (placeholder):**

- **By CVE:** `GET /advisories?cve_id=CVE-YYYY-NNNNN`
- **By ecosystem:** `ecosystem=npm` or `PyPI`, etc.
- **By severity:** `severity=critical` or `high`

---

## How to use this file

- **Add new query templates** for the same sources (e.g. more NVD params) or new vetted sources (with owner and URL).
- **Implement fetchers** that use these URLs and parameters; store results in [results/](results/).
- **Document scanner updates** driven by specific CVEs/CWEs in [scanner-updates.md](scanner-updates.md).
